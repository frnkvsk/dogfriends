{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/fv/js/capstone2/dogfriends/frontend/src/features/dogfriends/pages/Login.js\",\n    _s = $RefreshSig$();\n\n/** Login and Signup */\nimport React, { useState, useContext } from 'react';\nimport { makeStyles, AppBar, Tabs, Tab } from '@material-ui/core';\nimport { useHistory } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext';\nimport { useDispatch } from 'react-redux';\nimport SignupForm from '../components/SignupForm';\nimport LoginForm from '../components/LoginForm';\nimport { checkUsernameSlice, signUpSlice, loginSlice, getUserInfoSlice } from '../dogfriendsUserSlice';\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'flex-start',\n    width: '100%',\n    maxWidth: '500px',\n    paddingTop: '30px',\n    paddingBottom: '100px'\n  },\n  form: {\n    width: '100%',\n    backgroundColor: '#ffffff'\n  },\n  label: {\n    fontSize: '18px',\n    fontWeight: 'bold',\n    width: '90%',\n    margin: '10px 20px 0 20px'\n  },\n  input: {\n    width: '90%',\n    margin: '0 20px 0 20px'\n  },\n  button: {\n    display: 'flex',\n    justifyContent: 'flex-end',\n    margin: '10px 20px 15px'\n  },\n  err: {\n    color: '#ff1744',\n    fontSize: '24px'\n  }\n}));\nexport default function Login() {\n  _s();\n\n  const classes = useStyles();\n  const history = useHistory();\n  const auth = useContext(AuthContext);\n  const dispatch = useDispatch();\n  const [loginType, setValue] = useState('login');\n\n  const handleChange = (e, newValue) => {\n    setValue(newValue);\n  };\n\n  const handleLogin = async ({\n    username,\n    password\n  }) => {\n    try {\n      // verify username and password are correct\n      const resp = await dispatch(loginSlice({\n        username: username,\n        password: password\n      }));\n      console.log('LoginForm handleSubmitForm resp', resp); // if logged in, use resp.token to get user information\n\n      if (resp && resp.token.length) {\n        const userInfo = await dispatch(getUserInfoSlice({\n          token: resp.payload.token,\n          username: username\n        }));\n        auth.setAuthState({\n          userInfo: userInfo.payload.user,\n          token: resp.payload.token\n        });\n        return true;\n      } else {\n        console.log('resp && resp.token.length', resp, resp.token.length);\n        return false;\n      }\n    } catch (error) {\n      console.log(error);\n      return false;\n    }\n  }; // check if username is available\n\n\n  const handleCheckUsernameAvailability = async ({\n    username\n  }) => {\n    if (username.length) {\n      return await dispatch(checkUsernameSlice({\n        username\n      }));\n    }\n  };\n\n  const handleSignup = async ({\n    username,\n    password,\n    first_name,\n    last_name,\n    email\n  }) => {\n    const userInfo = {\n      username,\n      password,\n      first_name,\n      last_name,\n      email\n    };\n    console.log('SignupForm userInfo', userInfo);\n    const resp = await dispatch(signUpSlice(userInfo));\n    console.log('Login handleSignup resp', resp);\n\n    if (resp.payload.token) {\n      auth.setAuthState({\n        userInfo: userInfo,\n        token: resp.payload.token\n      });\n      history.push('/');\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.root,\n    children: [/*#__PURE__*/_jsxDEV(AppBar, {\n      position: \"static\",\n      children: /*#__PURE__*/_jsxDEV(Tabs, {\n        variant: \"fullWidth\",\n        value: loginType,\n        onChange: handleChange,\n        \"aria-label\": \"nav tabs example\",\n        TabIndicatorProps: {\n          style: {\n            backgroundColor: 'secondary',\n            height: '5px'\n          }\n        },\n        children: [/*#__PURE__*/_jsxDEV(Tab, {\n          label: \"Login\",\n          value: \"login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tab, {\n          label: \"Sign up\",\n          value: \"signup\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this), loginType === 'login' ? /*#__PURE__*/_jsxDEV(LoginForm, {\n      handleLogin: handleLogin\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(SignupForm, {\n      handlePreSignup: handleCheckUsernameAvailability,\n      handleSignup: handleSignup\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Login, \"D34NxU6xBMN2UcJdkU1aUBSCPV0=\", false, function () {\n  return [useStyles, useHistory, useDispatch];\n});\n\n_c = Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/home/fv/js/capstone2/dogfriends/frontend/src/features/dogfriends/pages/Login.js"],"names":["React","useState","useContext","makeStyles","AppBar","Tabs","Tab","useHistory","AuthContext","useDispatch","SignupForm","LoginForm","checkUsernameSlice","signUpSlice","loginSlice","getUserInfoSlice","useStyles","theme","root","display","flexDirection","alignItems","justifyContent","width","maxWidth","paddingTop","paddingBottom","form","backgroundColor","label","fontSize","fontWeight","margin","input","button","err","color","Login","classes","history","auth","dispatch","loginType","setValue","handleChange","e","newValue","handleLogin","username","password","resp","console","log","token","length","userInfo","payload","setAuthState","user","error","handleCheckUsernameAvailability","handleSignup","first_name","last_name","email","push","style","height"],"mappings":";;;;;AAAA;AACA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,UAA1B,QAA4C,OAA5C;AACA,SACEC,UADF,EAEEC,MAFF,EAGEC,IAHF,EAIEC,GAJF,QAKO,mBALP;AAMA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,WAAT,QAA4B,wBAA5B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,OAAOC,UAAP,MAAuB,0BAAvB;AACA,OAAOC,SAAP,MAAsB,yBAAtB;AACA,SACEC,kBADF,EAEEC,WAFF,EAGEC,UAHF,EAIEC,gBAJF,QAKO,wBALP;AAQA,MAAMC,SAAS,GAAGb,UAAU,CAAEc,KAAD,KAAY;AACvCC,EAAAA,IAAI,EAAE;AACJC,IAAAA,OAAO,EAAE,MADL;AAEJC,IAAAA,aAAa,EAAE,QAFX;AAGJC,IAAAA,UAAU,EAAE,QAHR;AAIJC,IAAAA,cAAc,EAAE,YAJZ;AAKJC,IAAAA,KAAK,EAAE,MALH;AAMJC,IAAAA,QAAQ,EAAE,OANN;AAOJC,IAAAA,UAAU,EAAE,MAPR;AAQJC,IAAAA,aAAa,EAAE;AARX,GADiC;AAWvCC,EAAAA,IAAI,EAAE;AACJJ,IAAAA,KAAK,EAAE,MADH;AAEJK,IAAAA,eAAe,EAAE;AAFb,GAXiC;AAevCC,EAAAA,KAAK,EAAE;AACLC,IAAAA,QAAQ,EAAE,MADL;AAELC,IAAAA,UAAU,EAAE,MAFP;AAGLR,IAAAA,KAAK,EAAE,KAHF;AAILS,IAAAA,MAAM,EAAE;AAJH,GAfgC;AAqBvCC,EAAAA,KAAK,EAAE;AACLV,IAAAA,KAAK,EAAE,KADF;AAELS,IAAAA,MAAM,EAAE;AAFH,GArBgC;AAyBvCE,EAAAA,MAAM,EAAE;AACNf,IAAAA,OAAO,EAAE,MADH;AAENG,IAAAA,cAAc,EAAE,UAFV;AAGNU,IAAAA,MAAM,EAAE;AAHF,GAzB+B;AA8BvCG,EAAAA,GAAG,EAAE;AACHC,IAAAA,KAAK,EAAE,SADJ;AAEHN,IAAAA,QAAQ,EAAE;AAFP;AA9BkC,CAAZ,CAAD,CAA5B;AAqCA,eAAe,SAASO,KAAT,GAAiB;AAAA;;AAC9B,QAAMC,OAAO,GAAGtB,SAAS,EAAzB;AACA,QAAMuB,OAAO,GAAGhC,UAAU,EAA1B;AACA,QAAMiC,IAAI,GAAGtC,UAAU,CAACM,WAAD,CAAvB;AACA,QAAMiC,QAAQ,GAAGhC,WAAW,EAA5B;AACA,QAAM,CAACiC,SAAD,EAAYC,QAAZ,IAAwB1C,QAAQ,CAAC,OAAD,CAAtC;;AAEA,QAAM2C,YAAY,GAAG,CAACC,CAAD,EAAIC,QAAJ,KAAiB;AACpCH,IAAAA,QAAQ,CAACG,QAAD,CAAR;AACD,GAFD;;AAIA,QAAMC,WAAW,GAAG,OAAO;AACzBC,IAAAA,QADyB;AAEzBC,IAAAA;AAFyB,GAAP,KAGd;AACJ,QAAI;AACF;AACA,YAAMC,IAAI,GAAG,MAAMT,QAAQ,CAAC3B,UAAU,CAAC;AACrCkC,QAAAA,QAAQ,EAAEA,QAD2B;AAErCC,QAAAA,QAAQ,EAAEA;AAF2B,OAAD,CAAX,CAA3B;AAIAE,MAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ,EAA8CF,IAA9C,EANE,CAOF;;AACA,UAAGA,IAAI,IAAIA,IAAI,CAACG,KAAL,CAAWC,MAAtB,EAA8B;AAC5B,cAAMC,QAAQ,GAAG,MAAMd,QAAQ,CAAC1B,gBAAgB,CAAC;AAC/CsC,UAAAA,KAAK,EAAEH,IAAI,CAACM,OAAL,CAAaH,KAD2B;AAE/CL,UAAAA,QAAQ,EAAEA;AAFqC,SAAD,CAAjB,CAA/B;AAKAR,QAAAA,IAAI,CAACiB,YAAL,CAAkB;AAChBF,UAAAA,QAAQ,EAAEA,QAAQ,CAACC,OAAT,CAAiBE,IADX;AAEhBL,UAAAA,KAAK,EAAEH,IAAI,CAACM,OAAL,CAAaH;AAFJ,SAAlB;AAIA,eAAO,IAAP;AACD,OAXD,MAWO;AACLF,QAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ,EAAwCF,IAAxC,EAA+CA,IAAI,CAACG,KAAL,CAAWC,MAA1D;AACA,eAAO,KAAP;AACD;AAEF,KAxBD,CAwBE,OAAOK,KAAP,EAAc;AACdR,MAAAA,OAAO,CAACC,GAAR,CAAYO,KAAZ;AACA,aAAO,KAAP;AACD;AACF,GAhCD,CAX8B,CA6C9B;;;AACA,QAAMC,+BAA+B,GAAG,OAAO;AAACZ,IAAAA;AAAD,GAAP,KAAsB;AAC5D,QAAGA,QAAQ,CAACM,MAAZ,EAAoB;AAClB,aAAO,MAAMb,QAAQ,CAAC7B,kBAAkB,CAAC;AAACoC,QAAAA;AAAD,OAAD,CAAnB,CAArB;AACD;AACF,GAJD;;AAMA,QAAMa,YAAY,GAAG,OAAO;AAC1Bb,IAAAA,QAD0B;AAE1BC,IAAAA,QAF0B;AAG1Ba,IAAAA,UAH0B;AAI1BC,IAAAA,SAJ0B;AAK1BC,IAAAA;AAL0B,GAAP,KAMb;AACN,UAAMT,QAAQ,GAAG;AACfP,MAAAA,QADe;AAEfC,MAAAA,QAFe;AAGfa,MAAAA,UAHe;AAIfC,MAAAA,SAJe;AAKfC,MAAAA;AALe,KAAjB;AAQAb,IAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAkCG,QAAlC;AACA,UAAML,IAAI,GAAG,MAAMT,QAAQ,CAAC5B,WAAW,CAAC0C,QAAD,CAAZ,CAA3B;AACAJ,IAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ,EAAsCF,IAAtC;;AACA,QAAGA,IAAI,CAACM,OAAL,CAAaH,KAAhB,EAAuB;AACrBb,MAAAA,IAAI,CAACiB,YAAL,CAAkB;AAChBF,QAAAA,QAAQ,EAAEA,QADM;AAEhBF,QAAAA,KAAK,EAAEH,IAAI,CAACM,OAAL,CAAaH;AAFJ,OAAlB;AAIAd,MAAAA,OAAO,CAAC0B,IAAR,CAAa,GAAb;AACD;AACF,GAzBD;;AA2BA,sBACE;AAAK,IAAA,SAAS,EAAE3B,OAAO,CAACpB,IAAxB;AAAA,4BACE,QAAC,MAAD;AAAQ,MAAA,QAAQ,EAAC,QAAjB;AAAA,6BACE,QAAC,IAAD;AACE,QAAA,OAAO,EAAC,WADV;AAEE,QAAA,KAAK,EAAEwB,SAFT;AAGE,QAAA,QAAQ,EAAEE,YAHZ;AAIE,sBAAW,kBAJb;AAKE,QAAA,iBAAiB,EACf;AACEsB,UAAAA,KAAK,EAAE;AACLtC,YAAAA,eAAe,EAAE,WADZ;AAELuC,YAAAA,MAAM,EAAE;AAFH;AADT,SANJ;AAAA,gCAcE,QAAC,GAAD;AAAK,UAAA,KAAK,EAAC,OAAX;AAAmB,UAAA,KAAK,EAAC;AAAzB;AAAA;AAAA;AAAA;AAAA,gBAdF,eAeE,QAAC,GAAD;AAAK,UAAA,KAAK,EAAC,SAAX;AAAqB,UAAA,KAAK,EAAC;AAA3B;AAAA;AAAA;AAAA;AAAA,gBAfF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADF,EAqBIzB,SAAS,KAAK,OAAd,gBACA,QAAC,SAAD;AAAW,MAAA,WAAW,EAAEK;AAAxB;AAAA;AAAA;AAAA;AAAA,YADA,gBAEA,QAAC,UAAD;AACE,MAAA,eAAe,EAAEa,+BADnB;AAEE,MAAA,YAAY,EAAEC;AAFhB;AAAA;AAAA;AAAA;AAAA,YAvBJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA+BD;;GA9GuBxB,K;UACNrB,S,EACAT,U,EAECE,W;;;KAJK4B,K","sourcesContent":["/** Login and Signup */\nimport React, { useState, useContext } from 'react';\nimport {\n  makeStyles,\n  AppBar,\n  Tabs,\n  Tab,\n} from '@material-ui/core';\nimport { useHistory } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext';\nimport { useDispatch } from 'react-redux';\nimport SignupForm from '../components/SignupForm';\nimport LoginForm from '../components/LoginForm';\nimport { \n  checkUsernameSlice,\n  signUpSlice, \n  loginSlice, \n  getUserInfoSlice \n} from '../dogfriendsUserSlice';\n\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'flex-start',\n    width: '100%',\n    maxWidth: '500px',\n    paddingTop: '30px',\n    paddingBottom: '100px',\n  },\n  form: {\n    width: '100%',\n    backgroundColor: '#ffffff',\n  },\n  label: {\n    fontSize: '18px',\n    fontWeight: 'bold',\n    width: '90%',\n    margin: '10px 20px 0 20px',\n  },\n  input: {\n    width: '90%',\n    margin: '0 20px 0 20px',\n  },\n  button: {\n    display: 'flex',\n    justifyContent: 'flex-end',\n    margin: '10px 20px 15px',\n  },\n  err: {\n    color: '#ff1744',\n    fontSize: '24px',\n  },\n\n}));\n\nexport default function Login() {\n  const classes = useStyles();\n  const history = useHistory();\n  const auth = useContext(AuthContext);\n  const dispatch = useDispatch();\n  const [loginType, setValue] = useState('login');\n\n  const handleChange = (e, newValue) => {\n    setValue(newValue);\n  }\n\n  const handleLogin = async ({\n    username,\n    password\n  }) => {\n    try {\n      // verify username and password are correct\n      const resp = await dispatch(loginSlice({\n        username: username,\n        password: password\n      }));\n      console.log('LoginForm handleSubmitForm resp',resp)\n      // if logged in, use resp.token to get user information\n      if(resp && resp.token.length) {\n        const userInfo = await dispatch(getUserInfoSlice({\n          token: resp.payload.token, \n          username: username\n        }));\n  \n        auth.setAuthState({\n          userInfo: userInfo.payload.user,\n          token: resp.payload.token,\n        });\n        return true;\n      } else {\n        console.log('resp && resp.token.length',resp , resp.token.length)\n        return false;\n      }      \n      \n    } catch (error) {\n      console.log(error)\n      return false;\n    }\n  }\n\n  // check if username is available\n  const handleCheckUsernameAvailability = async ({username}) => {\n    if(username.length) {\n      return await dispatch(checkUsernameSlice({username}));\n    }    \n  }\n  \n  const handleSignup = async ({\n    username,\n    password, \n    first_name,\n    last_name,\n    email\n    }) => {\n    const userInfo = {\n      username,\n      password,\n      first_name,\n      last_name, \n      email,\n    }\n    \n    console.log('SignupForm userInfo',userInfo)\n    const resp = await dispatch(signUpSlice(userInfo));\n    console.log('Login handleSignup resp',resp)\n    if(resp.payload.token) {\n      auth.setAuthState({\n        userInfo: userInfo,\n        token: resp.payload.token,\n      });\n      history.push('/');\n    }    \n  }  \n\n  return (    \n    <div className={classes.root}>\n      <AppBar position='static'>\n        <Tabs\n          variant='fullWidth'\n          value={loginType}\n          onChange={handleChange}\n          aria-label='nav tabs example'\n          TabIndicatorProps={\n            { \n              style: {\n                backgroundColor: 'secondary', \n                height: '5px',\n              },\n            }\n          }   \n        >\n          <Tab label='Login' value='login' />\n          <Tab label='Sign up' value='signup' />\n        </Tabs>\n      </AppBar>\n      \n      { loginType === 'login' ? \n        <LoginForm handleLogin={handleLogin}/> : \n        <SignupForm \n          handlePreSignup={handleCheckUsernameAvailability}\n          handleSignup={handleSignup} \n        /> \n      }\n    </div>\n  );\n}\n\n\n"]},"metadata":{},"sourceType":"module"}