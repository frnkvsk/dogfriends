{"ast":null,"code":"import * as AWS from 'aws-sdk';\nimport { v4 as uuid } from 'uuid';\nconst BUCKET_NAME = process.env.BUCKET_NAME;\nconst s3 = new AWS.S3({\n  region: process.env.AWS_DEFAULT_REGION,\n  secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\n  accessKeyId: process.env.AWS_ACCESS_KEY_ID\n});\n\nconst uploadToS3 = async data => {\n  console.log('DogfriendsPhotoApi uploadToS3 BUCKET_NAME', BUCKET_NAME);\n  let mime = data.name.slice(data.name.lastIndexOf('.'), data.name.length);\n  const name = uuid() + '.' + mime;\n  await s3.putObject({\n    Key: name,\n    Bucket: BUCKET_NAME,\n    ContentType: `image/${mime}`,\n    Body: data,\n    ACL: 'public-read'\n  }).promise();\n  return name;\n};\n\nconst postNewPhoto = async data => {\n  try {\n    const url = await uploadToS3(data);\n    console.log('url', url);\n    return url;\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nexport { postNewPhoto };","map":{"version":3,"sources":["/home/fv/js/capstone2/dogfriends/frontend/src/features/dogfriends/api/DogfriendsPhotosApi.js"],"names":["AWS","v4","uuid","BUCKET_NAME","process","env","s3","S3","region","AWS_DEFAULT_REGION","secretAccessKey","AWS_SECRET_ACCESS_KEY","accessKeyId","AWS_ACCESS_KEY_ID","uploadToS3","data","console","log","mime","name","slice","lastIndexOf","length","putObject","Key","Bucket","ContentType","Body","ACL","promise","postNewPhoto","url","error"],"mappings":"AAAA,OAAO,KAAKA,GAAZ,MAAqB,SAArB;AAEA,SAASC,EAAE,IAAIC,IAAf,QAA2B,MAA3B;AAEA,MAAMC,WAAW,GAAGC,OAAO,CAACC,GAAR,CAAYF,WAAhC;AAEA,MAAMG,EAAE,GAAG,IAAIN,GAAG,CAACO,EAAR,CAAW;AACpBC,EAAAA,MAAM,EAAEJ,OAAO,CAACC,GAAR,CAAYI,kBADA;AAEpBC,EAAAA,eAAe,EAAEN,OAAO,CAACC,GAAR,CAAYM,qBAFT;AAGpBC,EAAAA,WAAW,EAAER,OAAO,CAACC,GAAR,CAAYQ;AAHL,CAAX,CAAX;;AAMA,MAAMC,UAAU,GAAG,MAAOC,IAAP,IAAgB;AACjCC,EAAAA,OAAO,CAACC,GAAR,CAAY,2CAAZ,EAAwDd,WAAxD;AACA,MAAIe,IAAI,GAAGH,IAAI,CAACI,IAAL,CAAUC,KAAV,CAAgBL,IAAI,CAACI,IAAL,CAAUE,WAAV,CAAsB,GAAtB,CAAhB,EAA4CN,IAAI,CAACI,IAAL,CAAUG,MAAtD,CAAX;AACA,QAAMH,IAAI,GAAGjB,IAAI,KAAK,GAAT,GAAegB,IAA5B;AACA,QAAMZ,EAAE,CAACiB,SAAH,CAAa;AACjBC,IAAAA,GAAG,EAAEL,IADY;AAEjBM,IAAAA,MAAM,EAAEtB,WAFS;AAGjBuB,IAAAA,WAAW,EAAG,SAAQR,IAAK,EAHV;AAIjBS,IAAAA,IAAI,EAAEZ,IAJW;AAKjBa,IAAAA,GAAG,EAAE;AALY,GAAb,EAMHC,OANG,EAAN;AAOA,SAAOV,IAAP;AACD,CAZD;;AAcA,MAAMW,YAAY,GAAG,MAAOf,IAAP,IAAgB;AACnC,MAAI;AACF,UAAMgB,GAAG,GAAG,MAAMjB,UAAU,CAACC,IAAD,CAA5B;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkBc,GAAlB;AACA,WAAOA,GAAP;AACD,GAJD,CAIE,OAAOC,KAAP,EAAc;AACdhB,IAAAA,OAAO,CAACC,GAAR,CAAYe,KAAZ;AACD;AACF,CARD;;AAWA,SACEF,YADF","sourcesContent":["import * as AWS from 'aws-sdk';\n\nimport { v4 as uuid } from 'uuid';\n\nconst BUCKET_NAME = process.env.BUCKET_NAME;\n\nconst s3 = new AWS.S3({\n  region: process.env.AWS_DEFAULT_REGION,\n  secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,\n  accessKeyId: process.env.AWS_ACCESS_KEY_ID,\n});\n\nconst uploadToS3 = async (data) => {\n  console.log('DogfriendsPhotoApi uploadToS3 BUCKET_NAME',BUCKET_NAME)\n  let mime = data.name.slice(data.name.lastIndexOf('.'), data.name.length);\n  const name = uuid() + '.' + mime;\n  await s3.putObject({\n    Key: name,\n    Bucket: BUCKET_NAME,\n    ContentType: `image/${mime}`,\n    Body: data,\n    ACL: 'public-read',\n  }).promise(); \n  return name;\n}\n\nconst postNewPhoto = async (data) => {\n  try {\n    const url = await uploadToS3(data);\n    console.log('url',url)\n    return url;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n\nexport {\n  postNewPhoto,\n}"]},"metadata":{},"sourceType":"module"}